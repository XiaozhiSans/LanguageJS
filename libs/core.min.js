import*as jsyaml from"https://fastly.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.mjs";const version={name:[0,2,0],build:20240620,type:"alpha"},getFile=(e,t=0)=>{let a=new XMLHttpRequest;a.onreadystatechange=()=>{4===a.readyState&&200===a.status&&(()=>{let l={};if(0==t)l=language.yml.check(e)?language.yml.conver(a.responseText):JSON.parse(a.responseText);else{let t=language.yml.check(e)?language.yml.conver(a.responseText):JSON.parse(a.responseText);void 0!==t.type&&t.type.startsWith("xsl")&&(l[`${t.name}`]=t.lang,l.type=t.type)}language.temp=l,language.start()})()},a.open("GET",e,!0),a.send()},log=(...e)=>language.cfg.debug?print(`[language.js] ${e}`):null,injectHTML=(e,t=language.modes[0])=>{({innerHTML(e,t){(t.startsWith("xsl")?e:Object.entries(e.data)).forEach((e=>{findEles(t.startsWith("xsl")?`[${e.split("=")[0]}]`:`[al="${e[0]}"]`).forEach((a=>{try{a.innerHTML=t.startsWith("xsl")?shiftArray(e.split("=")).join("="):e[1]}catch(e){}}))}))},replaceText(e){e.forEach((e=>{findEle("html").innerHTML=findEle("html").innerHTML.replaceAll(e.split("=")[0],shiftArray(e.split("=")).join("="))}))}})[t](language.temp[e],language.temp.type||"al")};export const language={cfg:{checkUpdate:!0,debug:!1,defaultMode:"innerHTML",supportAl:!0,defaultArea:{},defaultLang:""},change(e){this.set(e),this.innerTexts(e,this.languages)},checkUpdate(){},init(){let e=navigator.language.split("-")[0]||"en";this.set(e)},modes:["innerHTML","replaceText"],regFile(e){getFile(e)},regFiles(...e){e.forEach((e=>{getFile(e,1)}))},set(e){let t=new Date;t.setDate(t.getDate()+7),document.cookie=`language=${e}; expires=${t}`},start(e=this.cfg.defaultMode){document.cookie.split("; ").forEach((e=>{if("lang"!==(e=e.split("="))[0])return this.init();this.lang=e[1]})),findEle("html").lang=this.lang,injectHTML(this.lang,e)},unRegAllFiles(){this.temp={},log("unreged all files.")},version:()=>`v${version.name.join(".")}-${version.type}-${version.build}`,yml:{check:e=>!!/(\.ya?ml)$/.test(e),conver:e=>jsyaml.load(e)}};console.log(`[language.js] ${language.version()} by XiaozhiSans`),log("core lib loaded\n debug mode is actived, will send log to consloe");